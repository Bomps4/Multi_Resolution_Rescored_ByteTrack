2024-04-11 15:10:50.470 | INFO     | Testing_library.Evaluator.Evaluator:evaluate_multires:99 - args: Namespace(batch_size=1, cache=False, ckpt='/home/bompani/CNN_Training/Training_experiements/NN_Train_test/Models/Pretrained/yoloxs_vid.pth', devices=1, dist_backend='nccl', dist_url=None, exp_file='/home/bompani/CNN_Training/BYTE_RESCORE/Experiments/BYTE_YOLOXS_multisize.py', experiment_name='BYTE_YOLOXS_multisize', fp16=True, logger='tensorboard', machine_rank=0, name=None, num_machines=1, occupy=False, opts=[], resume=False, start_epoch=None)
2024-04-11 15:10:50.476 | INFO     | Testing_library.Evaluator.Evaluator:evaluate_multires:100 - exp value:
╒════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════╕
│ keys               │ values                                                                                            │
╞════════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════╡
│ seed               │ None                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ output_dir         │ './YOLOX_outputs'                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ print_interval     │ 100                                                                                               │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ eval_interval      │ 3                                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ experiment_name    │ 'Experiment name'                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ archi_name         │ 'BYTES_YOLOXS'                                                                                    │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ num_classes        │ 30                                                                                                │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ depth              │ 0.33                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ width              │ 0.5                                                                                               │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ multisize          │ True                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ base_value         │ 114                                                                                               │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ act                │ 'silu'                                                                                            │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ mean               │ tensor([123.6750, 116.2800, 103.5300])                                                            │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ std                │ tensor([58.3950, 57.1200, 57.3750])                                                               │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ normalize          │ False                                                                                             │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ class_agnostic     │ True                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ bgr                │ True                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_num_workers   │ 0                                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ input_size         │ (320, 320)                                                                                        │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ multiscale_range   │ 5                                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ data_dir           │ '/scratch/ILSVRC2015/Data/VID/train/'                                                             │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ train_ann_dir      │ '/scratch/ILSVRC2015/Annotations/VID/train/'                                                      │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ val_dat_dir        │ '/scratch/ILSVRC2015/Data/VID/'                                                                   │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ val_ann_dir        │ '/scratch/ILSVRC2015/Annotations/VID/'                                                            │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ warmup_epochs      │ 3                                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ max_epoch          │ 20                                                                                                │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ warmup_lr          │ 0.005                                                                                             │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ basic_lr_per_img   │ 0.00015625                                                                                        │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ no_aug_epochs      │ 5                                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ ema                │ True                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ weight_decay       │ 4e-05                                                                                             │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ momentum           │ 0.9                                                                                               │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ save_history_ckpt  │ True                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ exp_name           │ 'BYTE_YOLOXS_multisize'                                                                           │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ resize_as_tensor   │ False                                                                                             │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ test_size          │ (576, 576)                                                                                        │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ test_conf          │ 0.4                                                                                               │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ nmsthre            │ 0.5                                                                                               │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ COCO               │ 'Imgvid'                                                                                          │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ swap               │ (2, 1, 0)                                                                                         │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ Add_Background     │ False                                                                                             │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ pretrained         │ True                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ reduced_size       │ (346, 346)                                                                                        │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ resize_frequency   │ 3                                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ seq_lenght         │ -1                                                                                                │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ pretrained_file    │ '/home/bompani/CNN_Training/Training_experiements/NN_Train_test/Models/Pretrained/yolox_nano.pth' │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ mosaic_augment     │ True                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ nntool_val_ann_dir │ '/home/bompani/CNN_Training/mini_dataset/Annotations/'                                            │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ nntool_val_dat_dir │ '/home/bompani/CNN_Training/mini_dataset/Data/'                                                   │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ xyxy               │ False                                                                                             │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ minimum_threshold  │ 0.1                                                                                               │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ rescoring          │ True                                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ iou_threshold      │ 0.3                                                                                               │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ lenght_track       │ 5                                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ min_hits           │ 2                                                                                                 │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ saving_dir         │ ('Testing_library/Evaluator_outputs/BYTE_YOLOXS_multisize_2024-04-11 '                            │
│                    │  '15:10:31.227905/')                                                                              │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ val_dataset        │ <Testing_library.Dataset.Imagenet.Imagenet_VID_Dataset object at 0x7f71502526d0>                  │
├────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┤
│ val_loader         │ <torch.utils.data.dataloader.DataLoader object at 0x7f715025c400>                                 │
╘════════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════╛
2024-04-11 15:10:50.505 | INFO     | Testing_library.Evaluator.Evaluator:resume_for_evaluation:296 - loading checkpoint for evaluation
2024-04-11 15:10:52.013 | INFO     | Testing_library.Evaluator.Evaluator:resume_for_evaluation:305 - loading state
2024-04-11 16:35:36.051 | INFO     | Testing_library.Evaluator.Evaluator:evaluate_multires:280 - All detected labels set()
2024-04-11 16:38:02.020 | ERROR    | Testing_library.utils.launch:launch:100 - An error has been caught in function 'launch', process 'MainProcess' (31247), thread 'MainThread' (140128735158400):
Traceback (most recent call last):

  File "eval_multires.py", line 69, in <module>
    launch(
    └ <function launch at 0x7f7154e16280>

> File "/home/bompani/CNN_Training/BYTE_RESCORE/Testing_library/utils/launch.py", line 100, in launch
    main_func(*args)
    │          └ (╒════════════════════╤══════════════════════════════════════════════════════════════════════════════════════════════════════...
    └ <function main at 0x7f7154e168b0>

  File "eval_multires.py", line 34, in main
    trainer = exp.get_trainer(args,val=True)
              │   │           └ Namespace(batch_size=1, cache=False, ckpt='/home/bompani/CNN_Training/Training_experiements/NN_Train_test/Models/Pretrained/y...
              │   └ <function Exp.get_trainer at 0x7f7154dc6a60>
              └ ╒════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════...

  File "/home/bompani/CNN_Training/BYTE_RESCORE/Testing_library/Experiments/yolo_base_multisize.py", line 505, in get_trainer
    trainer = Evaluator(self, args,val=val)
              │         │     │        └ True
              │         │     └ Namespace(batch_size=1, cache=False, ckpt='/home/bompani/CNN_Training/Training_experiements/NN_Train_test/Models/Pretrained/y...
              │         └ ╒════════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════...
              └ <class 'Testing_library.Evaluator.Evaluator.Evaluator'>

  File "/home/bompani/CNN_Training/BYTE_RESCORE/Testing_library/Evaluator/Evaluator.py", line 90, in __init__
    self.evaluate_multires()
    │    └ <function Evaluator.evaluate_multires at 0x7f70e3873700>
    └ <Testing_library.Evaluator.Evaluator.Evaluator object at 0x7f7150252580>

  File "/home/bompani/CNN_Training/BYTE_RESCORE/Testing_library/Evaluator/Evaluator.py", line 281, in evaluate_multires
    results=self.coco_eval.evaluation()
            │    │         └ <function COCO_EVAL.evaluation at 0x7f70e38d0940>
            │    └ <Testing_library.Evaluator.COCO_EVAL.COCO_EVAL object at 0x7f70e386ddf0>
            └ <Testing_library.Evaluator.Evaluator.Evaluator object at 0x7f7150252580>

  File "/home/bompani/CNN_Training/BYTE_RESCORE/Testing_library/Evaluator/COCO_EVAL.py", line 87, in evaluation
    return A_P+A_R+out_pre+out_recall
           │   └ [' \n Average Recall     (AR) @[ IoU=0.5:0.95 | area=   all | maxDets=  1 ] = 0.4168713490433466 \n', ' \n Average Recall    ...
           └ [' \n Average Precision  (AP) @[ IoU=0.5:0.95 | area=   all | maxDets=100 ] = 0.4358461209520201 \n', ' \n Average Precision ...

NameError: name 'out_pre' is not defined
